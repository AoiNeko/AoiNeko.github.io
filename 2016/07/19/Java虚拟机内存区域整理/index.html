<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="langley, liangli171@gmail.com"><title>Java虚拟机内存区域整理 · AoiNeko</title><meta name="description" content="#
Java Runtime 数据区1.程序计数器defination: 字节码解释器通过改变计数器的值选取下一条需要执行的字节码指令。
每条线程都会有一个独立的程序计数器，互不影响，这部分内存区域又叫“线程私有”
2.Java虚拟机栈线程私有，生命周期与线程相同
虚拟机栈描述java方法执行的内存"><meta name="keywords" content="Hexo,Java"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><e class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/mylogo.jpg" style="width:127px;"><h3 title=""><a href="/">AoiNeko</a></h3><div class="description"><p>一些个记录</p></div></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"></a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Hexo&#65281;</a></div></div></e><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Java虚拟机内存区域整理</a></h3></div><div class="post-content"><p>#</p>
<h3 id="Java-Runtime-数据区"><a href="#Java-Runtime-数据区" class="headerlink" title="Java Runtime 数据区"></a>Java Runtime 数据区</h3><h4 id="1-程序计数器"><a href="#1-程序计数器" class="headerlink" title="1.程序计数器"></a>1.程序计数器</h4><p>defination: 字节码解释器通过改变计数器的值选取下一条需要执行的字节码指令。</p>
<p><em>每条线程都会有一个独立的程序计数器，互不影响，这部分内存区域又叫“线程私有”</em></p>
<h4 id="2-Java虚拟机栈"><a href="#2-Java虚拟机栈" class="headerlink" title="2.Java虚拟机栈"></a>2.Java虚拟机栈</h4><p><em>线程私有，生命周期与线程相同</em></p>
<p>虚拟机栈描述java方法执行的内存模型: 方法执行同时 创建一个Stack Frame 用于存储局部变量表，操作数栈，动态链接，方法出口等信息。</p>
<p>一个方法从调用到执行完成：这个Stack Frame在虚拟机栈入栈到出栈的过程</p>
<p><em>局部变量表存放编译期可知的各种基本数据类型(boolean,byte,int,short,double,long,float,char),对象引用和returnAddress类型</em></p>
<p>本区域的异常：线程请求的栈深度大于虚拟机允许时 StackOverflowError，虚拟机扩展时内存不够抛出OutOfMemoryError</p>
<h4 id="3-本地方法栈"><a href="#3-本地方法栈" class="headerlink" title="3.本地方法栈"></a>3.本地方法栈</h4><p>类似虚拟机栈，区别是为虚拟机执行本地方法服务。<br>异常也与java虚拟机栈一致</p>
<p><em>Sun hotSpot虚拟机直接把本地方法栈和java虚拟机栈合二为一</em></p>
<h4 id="4-Java堆"><a href="#4-Java堆" class="headerlink" title="4.Java堆"></a>4.Java堆</h4><p>所有线程共享的一块内存区域，用于存放对象实例。在虚拟机启动时创建</p>
<p>异常：堆中没有内存完成实例分配，且堆无法再扩展时，抛出OutOfMemoryError</p>
<p>设置：-Xmx  -Xms</p>
<h4 id="5-方法区"><a href="#5-方法区" class="headerlink" title="5.方法区"></a>5.方法区</h4><p>线程共享，用于存储已被虚拟机加载的类信息，常量，静态变量，即时编译器编译后的代码等数据<br><em>原则上，如何实现方法区属于虚拟机实现细节</em></p>
<h5 id="5-1-运行时常量池"><a href="#5-1-运行时常量池" class="headerlink" title="5.1.运行时常量池"></a>5.1.运行时常量池</h5><p>方法区的一部分，Class文件有一项信息是常量池(Constant Pool table)。用于存放编译器生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放</p>
<p><em>运行期间也可能将新的常量放入池中，如String类的intern方法</em></p>
<p>异常：超过方法区的内存限制抛出OutOfMemoryError </p>
<p>设置 -XX：MaxPermSize</p>
<h4 id="P-S-直接内存"><a href="#P-S-直接内存" class="headerlink" title="P.S.直接内存"></a>P.S.直接内存</h4><p>并不是数据区的一部分 但是也可能导致OutOfMemoryError出现。NIO类 引入通道于缓冲区的I/O方式，可以使用Native函数库直接分配对外内存，然后通过一个存储在Java堆中的DirectByteBuffer对象最为这块内存的引用进行操作 </p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2016-07-19</span><i class="fa fa-tag"></i><a href="/tags/Java/" title="Java" class="tag">Java </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://yoursite.com/2016/07/19/Java虚拟机内存区域整理/,AoiNeko,Java虚拟机内存区域整理,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2016/07/19/markdown语法记录/" title="markdown语法记录" class="btn">上一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>